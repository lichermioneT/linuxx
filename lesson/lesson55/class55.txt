tcp收发消息的时候，工作模型。
双方两个朝向的可靠性
双方在进行通信的时候，可能除了正常的数据段。通信时也会涵盖确认数据段。

无论是C--S,还是S--C都需要应答。并行，并发。

tcp双发的地位是对等的。
只需要搞定一个朝向的通信过程

Client            Server  (tcp协议)
c1---s1
c2---s2
c3---s3
c4---s4
ack确认。

s的接收顺序不是一样的。
s的返回顺序怎么知道是哪个？
tcp数据段需要有方式标识数据段本身
注定了应答报文，对应的报头中，必定涵盖了确认序号。
确认应答&&确认序号：接收方已经收到了ACK序号之前的所有的(真的所有，而且连续的)报文。

为什么我们需要两组序号？？？
    全双工。client的序号，server的序号。分开。

Client                                                       Server
        tcp在这里发送数据的时候，快了也不行，慢了也不行--合适
        如何得知，我发送的数据数量是合适的
        反馈
        我们需要得到对方的接受缓冲区的的剩余空间的大小
        填自己的接受缓冲出
            因为我构建的所有的TCP报文，都要 发送 给对方！！
            对C--S同样适用。
            交换了接受能力！

        流量控制。

tcp报文也是有类型的！
c             s 
    三次握手
服务器会受到各种各样的tcp报文！
接受方根据不同的tcp报文，要有 不同的动作！
tcp正常的数据段，有的就是ack。

标记位。
SYN链接请求
FIN断开链接请求 
ACK标志位
RST

PSH 
缓冲区有人放数据，有人拿数据。
缓冲区数据太多了，缓冲区数据满了。发送方一直等吗？
PSH催促接收方，让上层尽快取走数据。

URG
数据对于接收方而言，数据乱序本身就是不可靠的表现。
要对收到的数据进行排序，保证数据的按顺序到达。
    报文是有序号的！            (数据想插队呢？)
    接收缓冲区的本质--queue。
URG需要被特殊尽快读取的数据，URG=1
这个数据在哪里呢？16紧急指针，在有效载荷的偏移量 一个字节。
URG带外数据。
    
RST
三次握手建立链接
三次握手，一定能保存握手成功吗？不一定，四次挥手也一样
即便是连接建立成功了，我们通信的过程中
有没有可能链接单方面出问题。
RST复位标志位。单方面出现问题。

字节流当做
char buffer[N] 当成数组。
只要拷贝到了发送缓冲区，每个字节，就天然有了序号。

超时重传机制。
丢包了，TCP策略，重传。
发送方如何判定丢包了呢？
真正有没有丢包，发送方其实不知道。定时的策略，超时了，判定丢包了。

接收方，可能会收到一样的数据，你们怎么看？也是不可可靠的一种，接收方要进行去重！ 如何去重，序号！

思考点，发送端，发出去的数据，被发出的数据，并不是我们想的那样马上被移除，而是必须维持一段时间！维持在哪里？
超时时间怎么定？一定不是固定的。数据传输情况由网络决定的。网络的情况一定是变化的。
