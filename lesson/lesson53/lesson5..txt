1对称加密
    加密解密一把锁
2非对称加密
    公钥，私钥。算法比较复杂，运行速度比较慢。
    公钥对明文加密--私钥变成密文。
    私钥对明文加密--公钥成密文。

如何理解加密的安全性
算力成本 1:10000

数据摘要&&数据指纹
    数据---》散列函数---》固定长度的字符串。（数据和字符串一对一）（经过hash,就是hash摘要。）  
    常见算法 MD5,SHA1, SHA256, SHA512.
    （不算加密，没有涉及到加密解密，这里不可逆的。）

数据摘要的作用
    1.百度网盘秒传的功能。
        你空空间大小只是给你 这么大的权限。
        电影---》 （百度 网盘）
        电影---》 （百度 网盘）
        电影---》 （百度 网盘）

        资源一样的 --》hash---》形成摘要。
        下一次---》数据形成摘要--》 （百度 网盘 搜索）
        找到了给你一个软链接（硬链接）。 秒传。
    对比两个文件是否是同一个文件。
    2.登录信息确认。
        a.一般涉及到用户密码的字段，必须是加密的
        b.一般数据库中的密码字段，长度是固定的，便于设计表结构

数据签名
    数据指纹---》加密---》数据指纹。

网络通信中，我们需要解决的是什么问题？？
1.数据被监听。
2.数据被篡改。
    所有在进程正常的加密数据通信之前，先解决双方如何看到秘钥的问题。
1.只使用对称加密 XXXX。
    鸡生蛋，蛋生鸡。
2.只使用非对称加密

Client                 Server  P p 
    1.发起秘钥协商 ----->
    2.<------推送自己的公钥P
    3.P非对称加密-------> (只有服务器能解密)
    4.（全世界都有公钥<-----服务器加密）

双方都使用非对称加密
C公钥C,C1                    S 公钥S, 私钥S1
      1.明文推送公钥C----->
      2.<----明文推送公钥S

      a.数据经过公钥S形成密文--->密文私钥S1解密。左右安全
      b.右左安全 密文C1解密 客户端<------响应公钥C加密,形成密文。
question a.两次加密解密太慢了，网络都慢了
question b.安全问题

对称加非对称。
C                S公钥S,私钥S1.
    1.请求公钥---->
    2.<-----解释S。
S 
Client形成对称秘钥C
C=>S=>X 
    3.推送------>X. X=>S1=>C 
    
    4.对称加密算法。

1.非对称加密，交换秘钥 安全 
2.对称加密，交换数据。 高效

方案2,3,4.都存在一个问题！
    如果是最开始就攻击了呢？

MITM攻击。

服务器具有非对称加密算法的公钥S，私钥S'。1
中间人具有非对称加密算法的公钥M，私钥M'。2
客户端向服务器发起请求，服务器明文传送公钥S给客户端。3
中间人劫持数据报文，提取公钥S并保存好，然后将被劫持报文中的公钥S替换成为自己的公钥M，并将伪造报文发给客户端。
客户端收到报文，提取公钥M（自己当然不知道公钥被更换过了），自己形成对称秘钥X，用公钥M加密X，形成报文发送给服务器。
中间人劫持后，直接用自己的私钥M‘进行解密，得到通信秘钥X，再用曾经保存的服务器端公钥S加密后，将报文推送给服务器。
服务器拿到报文，用自己的私钥S’解密，得到通信秘钥X。
双方开始采用X进行对称加密，进行通信。但是一切都在中间人的掌握中，劫持数据，进行窃听甚至修改，都是可以的。


方案5
    MITM攻击的本质是什么？服务返回公钥的时候，被中间人窃取并替换了&&Client没有辨别公钥是否合法的能力。
    围绕客户端能够，具有辨别服务器发过来的公钥的合法性。


证书的引入。
CA认证。

客户端     ←→      服务器
     ↑             ↑
     └── 信任 CA ──┘
Certificate Authority

数字证书（Digital Certificate）

生成密钥对
   ↓
生成 CSR
   ↓
提交 CA
   ↓
CA 验证身份
   ↓
CA 签发证书
   ↓
部署并使用


1.申请认证（证书）
2.信息审核
3.签发证书(Server)
(证书放在服务器里面，有期限的)

4.返回证书
5.验证证书(Client)
6.秘钥协商

数据签名是为了防止篡改。
签名
1.数据--散列函数--摘要--私钥加密--数据签名。  
2.数据和签名放在一起。
验证
1.数据散列
2.用签名者的公钥解密散列值。 


1.材料提交给CA机构。
    权威机构，为了签发证书，CA公钥，CA秘钥。CA秘钥只有自己知道。
    资料----》hash ---》形成摘要----》CA用自己的私钥加密----》数据签名。
    资料 + 数据签名 = 合起来。 CA颁发的证书。
因为我们使用CA的私钥进行 形成数据签名
所以，只有CA能形成可信的证书！

2.
Server                                              Client
              <----请求 
        证书推送给Client-->（里面存着CA私钥）     证书---------数据签名 
                                                hash摘要     CA会在所以的浏览器中内置CA自己的公钥！。对CA曾经的数据签名进行解密！
                                                数据摘要      曾经原始的数据摘要
                                                        上面相等，数据没有被篡改。 != 反之。
                                                目前，中间人没有办法进行任何局部的替换，无论是明文，还是签名。

https:非对称加密+对称加密+证书认证。
https生态，了解一下。

证书---》为什么需要加密。
明文信息---》 加密是为了让CA参与过程。
为什么需要先hash在加密呢？
    减少文本的数据大小。