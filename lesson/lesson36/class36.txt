生产消费模型
321

lock的存在

1.你创建多线程生产和消费的意义是什么？
2.生产消费模型的高效在哪里？
  可以再生产之前和消费之后，线程并行执行。 

生产者而言，向blockqueue里面放置任务:
  它的任务从哪里来的呢？它获取任务和构建任务要不要花时间？
  拿任务花费时间
消费者而言，向blockqueue里面拿取任务:
  对于消费者，难道把任务从任务队列拿出来就完了吗？消费者拿到任务之后，后续还有没有任务。
  处理任务花费时间

之前写代码的不足
1.一个线程，在操作临界资源的时候，必须临界资源是满足条件的！
2.可是，公共资源十分满足生产或者消费，我们无法直接得知，事前得知【在没有访问之前】
3.只能先加锁，在检查，在操作，在解锁。先加锁---本质你也是在访问临界资源！
因为我们再操作临界资源的时候，有可能不就绪，我们无法提前得知，只能先检查，根据检查结果决定下一步怎么走！

只要我们对资源整体加锁，就默认我们对这个资源整体使用，
实际情况：一份公共资源，允许同时访问不同的区域！
先申请信号量

信号量是什么，为什么
什么是信号量：
a.信号量本质是一把计数器。衡量临界资源中资源数量多少的计数器。
b.只要拥有信号量，就在未来一定能够拥有临界资源的一部分。申请信号量的本质：对临界资源中特定小块资源的预订机制。
有可能，我们在访问真正的临界资源之前，我们其实就可以提前知道临界资源的使用情况。成功有你的资源，失败只有等  间接判断。

线程要访问临界资源中的某一区域----申请信号量--所有人得先看到信号量---未来信号量本身必须是：公共资源
计数器-递减或者递增
int sem=10;
sem--; --申请资源   必须保证操作的原子性  --p操作
sem++; ++归还资源   必须保证操作的原子性  --v操作
信号量核心操作：PV原语

初步认识接口
sem_init()
sem_destroy()
sem_wait() p
sem_post() v

引入环形队列
环形队列---判断空，判断满
1.计数器
2.空一个位置

环形队列
生产者和消费者在什么情况下访问同一个位置：
1.空的时候
2.满的时候
3.其它情况，生产者和消费者，根本访问的就是不同的区域

1.你不能超过我
2.我不能把你套一个圈
3.我们两个什么是时候会站到一起
  盘子全为空
    我们两个站在一起，谁先运行呢？生产者
  盘子全都是满的
    我们两个站在一起，谁先运行呢？消费者
  
  其它情况，我们两个指向的是不同的位置
环形队列中，大部分情况，单生产和单消费是可以并发指向的！
只有在满和空，才满足互斥和同步的问题。
完成环形队列的核心问题？123

信号量是用来干什么的呢？
  信号量是用来衡量临界资源中的资源数量的
  对于生产者而言，看中什么？队列中的剩余空间-----------空间资源--定义信号量
  对于消费者而言，看中什么？队列中的放入队列中的数据---数据资源--定义信号量

代码
